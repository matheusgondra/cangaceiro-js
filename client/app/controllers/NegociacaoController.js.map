{"version":3,"sources":["../../app-src/controllers/NegociacaoController.js"],"names":["Negociacoes","NegociacaoService","Negociacao","NegociacoesView","MensagemView","Mensagem","DateConverter","getNegociacaoDao","Bind","getExceptionMessage","debounce","controller","bindEvent","NegociacaoController","constructor","inputData","inputQuantidade","inputValor","$","document","querySelector","bind","Object","assign","_negociacoes","_mensagem","_service","_init","dao","negociacoes","listarTodos","forEach","adiciona","negociacao","err","texto","event","preventDefault","_criaNegociacao","_limpaFormulario","_inputData","value","_inputQuantidade","_inputValor","focus","paraData","parseInt","parseFloat","apaga","apagaTodos","esvazia","importaNegociacoes","obtemNegociacoesDoPeriodo","console","log","filter","paraArray","some","novaNegociacao","equals","negociacaoExistente"],"mappings":";;;;;;AAASA,c,kBAAAA,W;AAAaC,oB,kBAAAA,iB;AAAmBC,a,kBAAAA,U;;AAChCC,kB,cAAAA,e;AAAiBC,e,cAAAA,Y;AAAcC,W,cAAAA,Q;AAAUC,gB,cAAAA,a;;AACzCC,mB,gBAAAA,gB;AAAkBC,O,gBAAAA,I;AAAMC,sB,gBAAAA,mB;AAAqBC,W,gBAAAA,Q;AAAUC,a,gBAAAA,U;AAAYC,Y,gBAAAA,S;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAG/DC,oB,WADZF,WAAW,OAAX,EAAoB,aAApB,EAAmC,QAAnC,C,UA6BCC,UAAU,QAAV,EAAoB,OAApB,C,UACAF,U,UA+BAE,UAAU,OAAV,EAAmB,cAAnB,C,UAYAA,UAAU,OAAV,EAAmB,gBAAnB,C,UACAF,U,2BAzEK,MAAMG,oBAAN,CAA2B;AACjCC,gBAAYC,SAAZ,EAAuBC,eAAvB,EAAwCC,UAAxC,EAAoD;AACnD,WAAMC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAV;AACAG,YAAOC,MAAP,CAAc,IAAd,EAAoB,EAAER,SAAF,EAAaC,eAAb,EAA8BC,UAA9B,EAApB;AACA,UAAKO,YAAL,GAAoB,IAAIhB,IAAJ,CACnB,IAAIR,WAAJ,EADmB,EAEnB,IAAIG,eAAJ,CAAoB,cAApB,CAFmB,EAGnB,UAHmB,EAGP,SAHO,CAApB;AAKA,UAAKsB,SAAL,GAAiB,IAAIjB,IAAJ,CAChB,IAAIH,QAAJ,EADgB,EAEhB,IAAID,YAAJ,CAAiB,eAAjB,CAFgB,EAGhB,OAHgB,CAAjB;AAKA,UAAKsB,QAAL,GAAgB,IAAIzB,iBAAJ,EAAhB;AACA,UAAK0B,KAAL;AACA;;AAEKA,SAAN,GAAc;AAAA;;AAAA;AACb,UAAI;AACH,aAAMC,MAAM,MAAMrB,kBAAlB;AACA,aAAMsB,cAAc,MAAMD,IAAIE,WAAJ,EAA1B;AACAD,mBAAYE,OAAZ,CAAoB;AAAA,eAAc,MAAKP,YAAL,CAAkBQ,QAAlB,CAA2BC,UAA3B,CAAd;AAAA,QAApB;AACA,OAJD,CAIE,OAAOC,GAAP,EAAY;AACb,aAAKT,SAAL,CAAeU,KAAf,GAAuB1B,oBAAoByB,GAApB,CAAvB;AACA;AAPY;AAQb;;AAIKF,YAAN,CAAeI,KAAf,EAAsB;AAAA;;AAAA;AACrB,UAAI;AACHA,aAAMC,cAAN;AACA,aAAMJ,aAAa,OAAKK,eAAL,EAAnB;;AAEA,aAAMV,MAAM,MAAMrB,kBAAlB;AACA,aAAMqB,IAAII,QAAJ,CAAaC,UAAb,CAAN;AACA,cAAKT,YAAL,CAAkBQ,QAAlB,CAA2BC,UAA3B;AACA,cAAKR,SAAL,CAAeU,KAAf,GAAuB,mCAAvB;AACA,cAAKI,gBAAL;AACA,OATD,CASE,OAAOL,GAAP,EAAY;AACb,cAAKT,SAAL,CAAeU,KAAf,GAAuB1B,oBAAoByB,GAApB,CAAvB;AACA;AAZoB;AAarB;;AAEDK,uBAAmB;AAClB,UAAKC,UAAL,CAAgBC,KAAhB,GAAwB,EAAxB;AACA,UAAKC,gBAAL,CAAsBD,KAAtB,GAA8B,CAA9B;AACA,UAAKE,WAAL,CAAiBF,KAAjB,GAAyB,GAAzB;AACA,UAAKD,UAAL,CAAgBI,KAAhB;AACA;;AAEDN,sBAAkB;AACjB,YAAO,IAAIpC,UAAJ,CACNI,cAAcuC,QAAd,CAAuB,KAAKL,UAAL,CAAgBC,KAAvC,CADM,EAENK,SAAS,KAAKJ,gBAAL,CAAsBD,KAA/B,CAFM,EAGNM,WAAW,KAAKJ,WAAL,CAAiBF,KAA5B,CAHM,CAAP;AAKA;;AAGKO,SAAN,GAAc;AAAA;;AAAA;AACb,UAAI;AACH,aAAMpB,MAAM,MAAMrB,kBAAlB;AACA,aAAMqB,IAAIqB,UAAJ,EAAN;AACA,cAAKzB,YAAL,CAAkB0B,OAAlB;AACA,cAAKzB,SAAL,CAAeU,KAAf,GAAuB,kCAAvB;AACA,OALD,CAKE,OAAOD,GAAP,EAAY;AACb,cAAKT,SAAL,CAAeU,KAAf,GAAuB1B,oBAAoByB,GAApB,CAAvB;AACA;AARY;AASb;;AAIKiB,sBAAN,GAA2B;AAAA;;AAAA;AAC1B,UAAI;AACH,aAAMtB,cAAc,MAAM,OAAKH,QAAL,CAAc0B,yBAAd,EAA1B;AACAC,eAAQC,GAAR,CAAYzB,WAAZ;AACAA,mBACE0B,MADF,CACS;AAAA,eAAkB,CAAC,OAAK/B,YAAL,CAAkBgC,SAAlB,GAA8BC,IAA9B,CAAmC;AAAA,gBAAuBC,eAAeC,MAAf,CAAsBC,mBAAtB,CAAvB;AAAA,SAAnC,CAAnB;AAAA,QADT,EAEE7B,OAFF,CAEU;AAAA,eAAc,OAAKP,YAAL,CAAkBQ,QAAlB,CAA2BC,UAA3B,CAAd;AAAA,QAFV;AAGA,cAAKR,SAAL,CAAeU,KAAf,GAAuB,+CAAvB;AACA,OAPD,CAOE,OAAOD,GAAP,EAAY;AACbmB,eAAQC,GAAR,CAAYpB,GAAZ;AACA,cAAKT,SAAL,CAAeU,KAAf,GAAuB1B,oBAAoByB,GAApB,CAAvB;AACA;AAXyB;AAY1B;AAtFgC,I","file":"NegociacaoController.js","sourcesContent":["import { Negociacoes, NegociacaoService, Negociacao } from \"../domain/index.js\";\nimport { NegociacoesView, MensagemView, Mensagem, DateConverter } from \"../ui/index.js\";\nimport { getNegociacaoDao, Bind, getExceptionMessage, debounce, controller, bindEvent } from \"../util/index.js\";\n\n@controller(\"#data\", \"#quantidade\", \"#valor\")\nexport class NegociacaoController {\n\tconstructor(inputData, inputQuantidade, inputValor) {\n\t\tconst $ = document.querySelector.bind(document);\n\t\tObject.assign(this, { inputData, inputQuantidade, inputValor });\n\t\tthis._negociacoes = new Bind(\n\t\t\tnew Negociacoes(),\n\t\t\tnew NegociacoesView(\"#negociacoes\"),\n\t\t\t\"adiciona\", \"esvazia\"\n\t\t);\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(),\n\t\t\tnew MensagemView(\"#mensagemView\"),\n\t\t\t\"texto\"\n\t\t);\n\t\tthis._service = new NegociacaoService();\n\t\tthis._init();\n\t}\n\n\tasync _init() {\n\t\ttry {\n\t\t\tconst dao = await getNegociacaoDao();\n\t\t\tconst negociacoes = await dao.listarTodos()\n\t\t\tnegociacoes.forEach(negociacao => this._negociacoes.adiciona(negociacao));\n\t\t} catch (err) {\n\t\t\tthis._mensagem.texto = getExceptionMessage(err);\n\t\t}\n\t}\n\n\t@bindEvent(\"submit\", \".form\")\n\t@debounce()\n\tasync adiciona(event) {\n\t\ttry {\n\t\t\tevent.preventDefault();\n\t\t\tconst negociacao = this._criaNegociacao();\n\t\t\t\n\t\t\tconst dao = await getNegociacaoDao();\n\t\t\tawait dao.adiciona(negociacao);\n\t\t\tthis._negociacoes.adiciona(negociacao);\n\t\t\tthis._mensagem.texto = \"Negociação adicionada com sucesso\";\n\t\t\tthis._limpaFormulario();\n\t\t} catch (err) {\n\t\t\tthis._mensagem.texto = getExceptionMessage(err);\n\t\t}\n\t}\n\n\t_limpaFormulario() {\n\t\tthis._inputData.value = \"\";\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\t\tthis._inputData.focus();\n\t}\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateConverter.paraData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\t@bindEvent(\"click\", \"#botao-apaga\")\n\tasync apaga() {\n\t\ttry {\n\t\t\tconst dao = await getNegociacaoDao();\n\t\t\tawait dao.apagaTodos();\n\t\t\tthis._negociacoes.esvazia();\n\t\t\tthis._mensagem.texto = \"Negociações apagadas com sucesso\";\n\t\t} catch (err) {\n\t\t\tthis._mensagem.texto = getExceptionMessage(err);\n\t\t}\n\t}\n\n\t@bindEvent(\"click\", \"#botao-importa\")\n\t@debounce()\n\tasync importaNegociacoes() {\n\t\ttry {\n\t\t\tconst negociacoes = await this._service.obtemNegociacoesDoPeriodo();\n\t\t\tconsole.log(negociacoes);\n\t\t\tnegociacoes\n\t\t\t\t.filter(novaNegociacao => !this._negociacoes.paraArray().some(negociacaoExistente => novaNegociacao.equals(negociacaoExistente)))\n\t\t\t\t.forEach(negociacao => this._negociacoes.adiciona(negociacao));\n\t\t\tthis._mensagem.texto = \"Negociações do período importadas com sucesso\";\n\t\t} catch (err) {\n\t\t\tconsole.log(err)\n\t\t\tthis._mensagem.texto = getExceptionMessage(err);\n\t\t}\n\t}\n}"]}