{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoDao.js"],"names":["Negociacao","NegociacaoDao","constructor","connection","_connection","_store","adiciona","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","listarTodos","negociacoes","cursor","openCursor","atual","result","value","_data","_quantidade","_valor","push","continue","apagaTodos","clear"],"mappings":";;;;;;AAASA,a,iBAAAA,U;;;OAEIC,a,GAAN,MAAMA,aAAN,CAAoB;AAC1BC,gBAAYC,UAAZ,EAAwB;AACvB,UAAKC,WAAL,GAAmBD,UAAnB;AACA,UAAKE,MAAL,GAAc,aAAd;AACA;;AAEDC,aAASC,UAAT,EAAqB;AACpB,YAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACvC,YAAMC,UAAU,KAAKP,WAAL,CACdQ,WADc,CACF,CAAC,KAAKP,MAAN,CADE,EACa,WADb,EAEdQ,WAFc,CAEF,KAAKR,MAFH,EAGdS,GAHc,CAGVP,UAHU,CAAhB;;AAKAI,cAAQI,SAAR,GAAoBC,KAAKP,SAAzB;AACAE,cAAQM,OAAR,GAAkBD,KAAK;AACtBE,eAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,cAAO,sCAAP;AACA,OAHD;AAIA,MAXM,CAAP;AAYA;;AAEDY,kBAAc;AACb,YAAO,IAAId,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACvC,YAAMa,cAAc,EAApB;;AAEA,YAAMC,SAAS,KAAKpB,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGboB,UAHa,EAAf;;AAKAD,aAAOT,SAAP,GAAmBC,KAAK;AACvB,aAAMU,QAAQV,EAAEI,MAAF,CAASO,MAAvB;;AAEA,WAAID,KAAJ,EAAW;AACV,cAAMnB,aAAa,IAAIP,UAAJ,CAClB0B,MAAME,KAAN,CAAYC,KADM,EAElBH,MAAME,KAAN,CAAYE,WAFM,EAGlBJ,MAAME,KAAN,CAAYG,MAHM,CAAnB;AAKAR,oBAAYS,IAAZ,CAAiBzB,UAAjB;AACAmB,cAAMO,QAAN;AACA,QARD,MAQO;AACNxB,gBAAQc,WAAR;AACA;AACD,OAdD;AAeAC,aAAOP,OAAP,GAAiBD,KAAK;AACrBE,eAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,cAAO,yCAAP;AACA,OAHD;AAIA,MA3BM,CAAP;AA4BA;;AAEDwB,iBAAa;AACZ,YAAO,IAAI1B,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACvC,YAAMC,UAAU,KAAKP,WAAL,CACdQ,WADc,CACF,CAAC,KAAKP,MAAN,CADE,EACa,WADb,EAEdQ,WAFc,CAEF,KAAKR,MAFH,EAGd8B,KAHc,EAAhB;;AAKAxB,cAAQI,SAAR,GAAoBC,KAAKP,SAAzB;;AAEAE,cAAQM,OAAR,GAAkBD,KAAK;AACtBE,eAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,cAAO,wCAAP;AACA,OAHD;AAIA,MAZM,CAAP;AAaA;AAlEyB,I","file":"NegociacaoDao.js","sourcesContent":["import { Negociacao } from \"./Negociacao.js\";\r\n\r\nexport class NegociacaoDao {\r\n\tconstructor(connection) {\r\n\t\tthis._connection = connection;\r\n\t\tthis._store = \"negociacoes\";\r\n\t}\r\n\r\n\tadiciona(negociacao) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst request = this._connection\r\n\t\t\t\t.transaction([this._store], \"readwrite\")\r\n\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t.add(negociacao);\r\n\r\n\t\t\trequest.onsuccess = e => resolve();\r\n\t\t\trequest.onerror = e => {\r\n\t\t\t\tconsole.log(e.target.error);\r\n\t\t\t\treject(\"Não foi possível salvar a negociação\")\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tlistarTodos() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst negociacoes = [];\r\n\r\n\t\t\tconst cursor = this._connection\r\n\t\t\t\t.transaction([this._store], \"readwrite\")\r\n\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t.openCursor();\r\n\r\n\t\t\tcursor.onsuccess = e => {\r\n\t\t\t\tconst atual = e.target.result;\r\n\r\n\t\t\t\tif (atual) {\r\n\t\t\t\t\tconst negociacao = new Negociacao(\r\n\t\t\t\t\t\tatual.value._data,\r\n\t\t\t\t\t\tatual.value._quantidade,\r\n\t\t\t\t\t\tatual.value._valor\r\n\t\t\t\t\t);\r\n\t\t\t\t\tnegociacoes.push(negociacao);\r\n\t\t\t\t\tatual.continue();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve(negociacoes);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tcursor.onerror = e => {\r\n\t\t\t\tconsole.log(e.target.error);\r\n\t\t\t\treject(\"Não foi possível listar nas negociações\");\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tapagaTodos() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst request = this._connection\r\n\t\t\t\t.transaction([this._store], \"readwrite\")\r\n\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t.clear();\r\n\r\n\t\t\trequest.onsuccess = e => resolve();\r\n\r\n\t\t\trequest.onerror = e => {\r\n\t\t\t\tconsole.log(e.target.error);\r\n\t\t\t\treject(\"Não foi possível apagar as negociações\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}"]}